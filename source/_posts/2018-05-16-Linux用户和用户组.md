---
title: 【Linux】Linux用户管理 用户和用户组及配置文件
tags: Linux
abbrlink: 4ac3f250
date: 2018-05-06 22:41:15
---


Linux是一个多用户的系统，那么如何保证不同用户之间不冲突，也能保证各个用户的隐私呢，这涉及到了用户管理和权限管理，先讲用户管理

## 用户
用户就是使用操作系统的人，用户分为两类，超级用户和普通用户，而每一个用户都会有一个id，叫`UID`，系统中实际使用的是`UID`。

- 超级用户：root，UID为0
- 普通用户：UID可以为1-65535（实际没到这么多）
    + 系统用户：对守护进程获取资源进行权限分配，UID在1-499之间（实际是设置的，不一定是500，CentOS 6: ID<500，CentOS 7: ID<1000）
    + 登录用户：能够交互式登录的用户，UID在500+
    + 虚拟用户：不能登录的用户，比如vsftp

<!--more-->

## 用户组
用户组就是具有相同系统权限的一组用户，用户组分为基本组（主组）和附加组（额外组），其中基本组的组名和用户名是一样的，是在创建用户的同时创建的，该组只包含该用户，为用户的私有组

用户可以同时属于多个组，一个是主要组，其他的为附属组


## 配置文件
配置文件有这么四个，用户和组，用户密码和用户组密码
- ``/etc/passwd``：用户及其属性信息
- ``/etc/group``：组及其属性信息
- ``/etc/shadow``：用户密码及相关属性
- ``/etc/gshadow``：组密码及其相关属性

### /etc/passwd
这个文件存储当前系统中所有用户的信息，`passwd`命令可以修改用户密码，`man 5 passwd`可以查看对应的`/etc/passwd`格式


user  :     x     :   123     ：   456       ： xxxx   ：/home/user ： /bin/bash
用户名 : 密码占位符 : 用户编号UID : 用户组编号GID : 注释信息 ：用户主目录 ：   shell类型


### /etc/group
这个文件存储当前系统中所有用户组的信息，`man 5 group`可以查看该文件的说明

Group ：   x	   ：   501   ：  abc,def,xyz
组名称 ：组密码占位符 : 组编号GID ：以当前组为**附加组**的用户列表(分隔符为逗号)




### /etc/shadow
存储当前系统中所有用户的密码信息，使用命令`man 5 shadow`查看该文件的说明

用户名:加密了的密码:最近一次更改密码的日期:密码的最小使用期限:最大密码使用期限:密码警告时间段:密码禁用期:账户过期日期:保留字段

**最后一次更改密码的日期**
    最近一次更改密码的时间，表示从1970年1月1日开始的天数。
    0 有特殊意思，表示用户应该在下次登录系统时更改密码。
    空字段表示密码年龄功能被禁用。

**密码的最小年龄**
    最小密码年龄是指，用户一次更改密码之后，要等多长时间才再次被允许更改密码。
    空字段或 0 表示没有最小密码年龄。

**最大密码年龄**
    最大密码年龄是指，这写天之后，用户必须更改密码。
    这写天之后，密码仍然可用。用户将会在下次登录的时候被要求更改密码。
    空字段表示没有最大密码年龄，没有密码警告时间段，没有密码禁用时间段。
    如果最大密码年龄小于最小密码年龄，用户将会不能更改密码。

**密码警告时间段**
    密码过期之前，提前警告用户的的天数(请参考上边的密码的最大年龄)。
    空字段或者 0 表示没有密码警告期。

**密码禁用期**
    密码过期(查看上边的密码最大年龄)后，仍然接受此密码的天数(在此期间，用户应该在下次登录时修改密码)。
    密码到期并且过了这个宽限期之后，使用用户的当前的密码将会不能登录。用户需要联系系统管理员。空字段表示没有强制密码过期。

**账户过期日期**
    账户过期的日期，表示从1970年1月1日开始的天数。
    注意，账户过期不同于密码过期。账户过期时，用户将不被允许登录；密码过期时，用户将不被允许使用其密码登录。
    空字段表示账户永不过期。
    应该避免使用 0，因为它既能理解成永不过期也能理解成在1970年1月1日过期。

!!表示禁止登录


加密机制
加密：明文--> 密文
解密：密文--> 明文

单向加密：提取数据指纹
    md5: message digest, 128bits
    sha1: secure hash algorithm, 160bits
    sha224: 224bits
    sha256: 256bits
    sha384: 384bits
    sha512: 512bits

雪崩效应：初始的条件的微小改变，将会引起结果的巨大改变；
定长输出：不同长度的密码会输出相同长度的密文
如果密码相同也是不一样的，因为会在密码中添加一个随机的字符串

密码的复杂性策略：
1. 使用数字、大写字母、小写字母及特殊字符中至少3种；
2. 足够长；
3. 使用随机密码；
4. 定期更换；不要使用最近曾经使用过的密码；


### /etc/gshadow
存储当前系统中用户组的密码信息
Group：	*	  ：      ：abc,def,xyz
组名称：  组密码	：组管理者：组中用户名列表





<!-- 资源分派：
    Authentication：认证
    Authorization：授权
    Accouting：审计
        Audition

    token, identity(username/password)  


Linux安全上下文：
    运行中的程序：进程 (process)

        以进程发起者的身份运行：
            root: cat
            tom: cat

        进程所能够访问的所有资源的权限取决于进程的发起者的身份； -->









参考：
* https://www.thegeekdiary.com/understanding-etclogin-defs-file/